[TOC]

## 一、介绍

*单例模式（Singleton）*是一种创建型设计模式，能够保证一个类只有一个实例，并且提供一个全局访问接口。

### 1.1 解决问题

单例模式解决了两个问题：

1. 提供访问共享资源的单一入口。

   有些资源，例如数据库或一个文件，在程序中往往只需要一个实例，而不希望有多个实例存在，因为可能会造成潜在的数据不一致或冲突。

2. 避免共享资源被错误修改。

   利用封装，单例模式能够保证单一实例的修改是可控的。

### 1.2 类图结构



## 二、实现样例

实现单例模式需要包含以下两个步骤：

- 确保构造函数是 ***私有的（private）***，从而避免其他对象创建单例类的实例。
- 创建一个 ***静态方法*** 提供全局访问接口，该方法调用私有构造函数来创建一个实例，并且保存在静态区；或者使用静态指针，数据保存在堆。

> 在多线程中，静态变量的底层能够保证首次初始化的线程安全性。

### 2.1 *C++* 实现



## 三、注意事项

- *Windows* 平台跨 *DLL* 使用时，**需要使用 `dllexport` 导出，否则其他动态库无法访问该单例类**。

  在跨模块使用时，还注意静态方法**全局访问接口的实现不要写在类声明的头文件**中，而是在对应的 *cpp* 文件中实现。在头文件中实现会导致每个使用该 *DLL* 的其他库都存在一个单例副本，导致跨模块单例失效，每个模块的单例相互独立。

