[TOC]

## 前言

几何概念这一节主要介绍一些高中和大学高数的几何知识，涉及线性代数的少部分知识，但很浅显，只是帮助唤醒记忆，属抛砖引玉。此外由于计算机图形学确实需要一定的高数、线代基础，在阅读后面章节时如果遇到疑问，请自行学习相关知识。

该章节的公式较多，但并不复杂，都是基础知识，所以不必恐慌。此外，部分小节的内容比较平淡，属于将结论给出，不必强行记忆，之后用到时再来查看即可。

## 一、直线与平面

### 1.1 二维坐标系

#### 1.1.1 点与直线

二维坐标系中的点只有两个方向： $x$ 与 $y$ ，因此点的位置通过 $(x,y)$ 即可确定。

二维坐标系中的直线表示形式有两种：
$$
Ax+By+C=0
\\y=mx+b
\\ \\
& \scriptsize{Note:m=\frac{-A}{B},b=\frac{-C}{B}}
$$
其中 $m$ 表示斜率，$b$ 为直线与 $y$ 轴交点的 $y$ 坐标。当 $B=0$ 时，直线与 $y$ 轴平行且与 $x$ 轴相交于 $(0,\frac{-C}{A})$。

对直线的等式作非零除法并不改变直线的特征，往往除法用作标准化，用于方便计算某些值，例如直线到原点之间的距离：
$$
Distance=\frac{|C|}{\sqrt{A^2+B^2}}
$$

#### 1.1.2 平行与垂直

给出两条直线：
$$
&Ax+By+C=0\\
&Ex+Fy+G=0
$$
两条直线平行相当于**斜率相等**，由于计算机中实数的精度有限，因此可以转换为乘法等式：
$$
AF=BE
$$
同样地，两条直线垂直相当于**斜率乘积互为相反数**，同样可以转换为乘法等式：
$$
AE=-BF
$$

> 没写推导过程，因为过于简单。

### 1.2 三维坐标系

#### 1.2.1 点与平面

三维坐标系的点通过 $x$ ， $y$ 和 $z$ 确定位置，即 $(x,y,z)$。

平面的表示方法与直线表示方法相似，只是多了一个自由度（坐标轴），通常表示方法如下：
$$
Ax+By+Cz+D=0
$$
平面到原点的距离：
$$
Distance=\frac{|D|}{\sqrt{A^2+B^2+C^2}}
$$
在二维坐标系中，直线通过斜率表示其斜度，三维坐标系中，平面则通过**梯度**表示其斜度，梯度的值通常根据平面的**法向量**进行计算得到。平面梯度的表示方法如下：
$$
\triangledown(f)=\langle\frac{\partial{f}}{\partial{x}}, \frac{\partial{f}}{\partial{y}}, \frac{\partial{f}}{\partial{z}}\rangle
$$
在三维坐标系中，直线无法通过一个方程式表示，一般一条直线为两个平面相交的产物，因此需要平面方程的方程组来表示。

> 在三维坐标系中，上述**平面方程与直线方程**进行**几何运算**时的计算量比较庞大，只是计算直线与平面的交点，就需要联立多个方程组求解。

#### 1.2.2 向量（*Vector*）

二维坐标系和三维坐标系都有向量的概念，但在三维坐标系中，向量的用途更为广泛。本文中向量使用粗体的字母表示，例如 $\bold{a}$ 或 $\bold{A}$ 。

在本文中，向量区分**位置向量**和**方向向量**：

* 位置向量标识某个点的位置，通常为原点到该店所表示的向量。

* 方向向量表示方位，其长度无关紧要，通常使用单位长度的向量表示

一般 $\bold{a}$ （小写字母）为方向向量， $\bold{A}$ （大写字母）为位置向量。

上述定义仅是一种用法上的习惯，向量本身并无区别。

向量在几何计算中最大的优势就是**坐标自由（*Coordinate Free*）**，因此后面的章节中除非特别说明，均为向量表达式。

> 坐标自由最大的好处就是几何变换不影响其几何形状，这一点会在之后的章节表现的更加清楚，此处不必深究。

向量可以进行加减，并可以进行数乘，即数字常量与向量相乘。向量之间的乘法分为**点乘**与**叉乘**。

> 点乘又称为**向量内积**。
>
> 叉乘又称为**向量外积**。

向量的长度是所有方向分量平方和的平方根，通常用 $|\bold{a}|$ 表示：
$$
|\bold{a}|=\sqrt{x^2+y^2+z^2}
$$

##### 1.2.2.1 向量点乘

向量点乘的**结果为一个数值**，定义为：
$$
\begin{align}
\bold{a}\cdot\bold{b}&=|\bold{a}||\bold{b}|\cos(t)\\
&=a_1b_1+a_2b_2+a_3b_3
\end{align}
$$

> 向量点乘**适用交换律**。

给出两个向量：
$$
\bold{a}=<1,2,3>\\
\bold{b}=<2,-1,4>
$$
则
$$
\bold{a}\cdot\bold{b}=1*2+2*(-1)+3*4
$$
其中 $t$ 为 $\bold{a}$ 与 $\bold{b}$ 之间的夹角。

通过向量点乘，可以得到两个向量之间的位置关系：

* **垂直**

  $|\bold{a}|$ 与 $|\bold{b}|$ 不为 $0$，而二者点乘结果为 $0$，则表示二者夹角的 $\cos$ 值为 $0$，即夹角为 **$90\degree$**。

* **平行**

  $\bold{a}\cdot\bold{b}=|\bold{a}||\bold{b}|$ ，则表示二者夹角的 $\cos$ 为 $1$ ，即夹角为 $0\degree$。

##### 1.2.2.2 向量叉乘

向量叉乘的**结果仍是一个向量**，定义为：
$$
\bold{a}\times\bold{b}=\langle
\begin{vmatrix}
a_2 & a_3 \\
b_2 & b_3
\end{vmatrix},
-\begin{vmatrix}
a_1 & a_3 \\
b_1 & b_3
\end{vmatrix},
\begin{vmatrix}
a_2 & a_2 \\
b_2 & b_2
\end{vmatrix}
\rangle
$$

> 其方向满足**右手定律**，也因此向量叉乘**不适用交换律**。

向量叉乘的结果为一个向量，其长度为：
$$
|\bold{a}\times\bold{b}|=|\bold{a}||\bold{b}|\sin(t)
$$
其中 $t$ 为 $\bold{a}$ 与 $\bold{b}$ 之间的夹角。

##### 1.2.2.3 直线向量方程

直线通过一个点和方向即可确定，对于一个基于点 $\bold{B}$ 和方向向量 $\bold{d}$ 的直线，其直线向量方程为：
$$
\bold{X}=\bold{B}+t\bold{d}
$$
其中 $t$ 为一个参数， $\bold{X}$ 为变量，表示直线上任意一个点。

##### 1.2.2.4 平面向量方程

平面通过平面上的两点，以及其法向量即可确定，对于一个平面，任选平面上一个基点 $\bold{B}$ ，该基点的法向量为 $\bold{n}$，则在平面上任意一个点 $\bold{X}$，应当有：
$$
(\bold{X}-\bold{B})\cdot\bold{n}=0
$$
根据点乘的分配律，能得到平面向量方程：
$$
\bold{X}\cdot\bold{n}-\bold{B}\cdot \bold{n}=0
$$
其中 $\bold{X}$ 为**变量**，表示平面上任意一个点。

##### 1.2.2.5 直线与平面的交点

有了向量方程，求解三维坐标系下的直线与平面的交点就容易很多。

给出直线
$$
\bold{X}=\bold{A}+t\bold{d}
$$
和平面
$$
\bold{X}\cdot\bold{n}-\bold{B}\cdot \bold{n}=0
$$
则其交点只需要分别满足直线与平面的方程即可，即：
$$
&(\bold{A}+t\bold{d})\cdot \bold{n}-\bold{B}\cdot\bold{n}=0\\
\Rightarrow &t=\frac{(\bold{B}-\bold{A})\cdot\bold{n}}{\bold{d}\cdot\bold{n}}
$$
将 $t$ 带入直线向量方程即可得到交点向量。

上面的求解过程中，存在两个临界情况：

* 如果 $\bold{d}\cdot\bold{n}=0$，则表示直线与平面平行，即 $\bold{d}$ 与 $\bold{n}$ 垂直。

* 如果 $\bold{B}-\bold{A}$ 不为 $0$ 且 $(\bold{B}-\bold{A})\cdot\bold{n}=0$，则表示直线在平面上：

  因为前者保证 $\bold{B}$ 与 $\bold{A}$ 为不同的位置向量，后者说明向量 $\bold{B}-\bold{A}$ 与 $\bold{n}$ 垂直。

## 二、简单曲线与曲面

该小节主要介绍一下简单的曲线和曲面，了解一般的方程定义即可，不需要过分关注几何性质，可以后续章节遇到疑问时再学习。

### 2.1 曲线

#### 2.1.1 二次曲线的标准方程

##### 2.1.1.1 圆

圆的标准方程定义为：
$$
(x-a)^2+(y-b)^2=r^2
$$
也可定义为极坐标形式：
$$
x=a+r\cos(t)\\
y=b+r\sin(t)
$$
其中圆心为 $(a,b)$ ，圆的半径为 $r$ 。

##### 2.1.1.2 椭圆

椭圆的标准方程定义为：
$$
\frac{x^2}{a^2}+\frac{y^2}{b^2}=1
$$
也可定义为极坐标形式：
$$
x=a\cos(t)\\
y=b\sin(t)
$$
其中长轴与短轴的长度分别为 $a$ 、 $b$ 中的较大值与较小值。

##### 2.1.1.3 双曲线

双曲线的标准方程定义为：
$$
\frac{x^2}{a^2}-\frac{y^2}{b^2}=1
$$
也可定义为极坐标形式：
$$
x=a\sec(t)\\
y=b\tan(t)
$$
其中长轴与短轴的长度分别为 $a$ 、 $b$ 中的较大值与较小值。标准形式的双曲线与 $x$ 轴交点分别为 $(a,0)$ 和 $(-a,0)$，与 $y$ 轴没有交点。

##### 2.1.1.4 抛物线

抛物线的标准方程定义为：
$$
x^2=4py
$$
标准形式的抛物线的 $y$ 坐标一定**恒**小于等于零或**恒**大于等于零，表现为抛物线开口向上或向下。

### 2.1.3 二次曲线的一般方程

二次曲线的一般方程定义为：
$$
Ax^2+2Bxy+Cy^2+2Dx+2Ey+F=0
$$
一般方程存在 $6$ 个系数，通过除以一个非零系数可以将系数数量简化为 $5$ 个。

通常人们更希望通过一般方程能够直接看出该曲线的形状和类型，判断方法如下：

* 若 $B^2<A*C$ ，曲线为椭圆
* 若 $B^2=A*C$ ，曲线为抛物线
* 若 $B^2<A*C$ ，曲线为双曲线

$B^2-A*C$ 又被称为二次曲线的**判别式（*Discriminant*）**，上述判别方法即根据判别式得到。

### 2.1.4 二次曲线的矩阵方程

使用矩阵方程表示二次曲线时会非常漂亮。

有以下定义：
$$
x=
\begin{bmatrix}
x\\
y\\
1
\end{bmatrix},
x^T=
\begin{bmatrix}
x\ y\ 1
\end{bmatrix},
Q=
\begin{bmatrix}
A &B &D\\
B &C &E\\
D &E &F
\end{bmatrix}
$$
其中 $Q$ 为系数矩阵，很明显 $Q$ 为一个对称矩阵。

则二次曲线的矩阵方程为：
$$
x^TQx=0
$$
其分析方法可以使用**线性代数**相关知识解决。

## 2.2 曲面

### 2.2.1 二次曲面的标准方程

二次曲面的标准方程主要有九种：

| 曲面类型                                 | 示意图 | 标准方程                                                   | 备注         |
| ---------------------------------------- | ------ | ---------------------------------------------------------- | ------------ |
| 椭球面（*Ellipsoid*）                    |        | $\frac{x^2}{a^2} + \frac{y^2}{b^2} + \frac{z^2}{c^2} = 1$  | 四阶二次曲面 |
| 单叶双曲面（*Hyperboloid of One Sheet*） |        | $\frac{x^2}{a^2} + \frac{y^2}{b^2} - \frac{z^2}{c^2} = 1$  | 四阶二次曲面 |
| 双叶双曲面（*Hyperboloid of Two Sheet*） |        | $-\frac{x^2}{a^2} - \frac{y^2}{b^2} + \frac{z^2}{c^2} = 1$ | 四阶二次曲面 |
| 椭圆抛物面（*Elliptic Paraboloid*）      |        | $\frac{x^2}{a^2}+\frac{y^2}{b^2}=2cz$                      | 四阶二次曲面 |
| 双曲线抛物面（*Hyperbolic Paraboloid*）  |        | $\frac{x^2}{a^2}-\frac{y^2}{b^2}=2cz$                      | 四阶二次曲面 |
| 圆锥面（*Cone*）                         |        | $\frac{x^2}{a^2} + \frac{y^2}{b^2} - \frac{z^2}{c^2} = 0$  | 三阶二次曲面 |
| 椭圆柱面（*Elliptic Cylinder*）          |        | $\frac{x^2}{a^2}+\frac{y^2}{b^2}=1$                        | 三阶二次曲面 |
| 双曲线圆柱面（*Hyperbolic Cylinder*）    |        | $\frac{x^2}{a^2}-\frac{y^2}{b^2}=1$                        | 三阶二次曲面 |
| 抛物线圆柱面（*Parabolic Cylinder*）     |        | $x^2=4py$                                                  | 三阶二次曲面 |

### 2.2.2 二次曲面的一般方程

二次曲面的一般方程定义为：
$$
Ax^2+By^2+Cz^2+2Dxy+2Exz+2Fyz+2Gx+2Hy+2Iz+J=0
$$
类似二次曲线一一般方程，可以将其中的 $10$ 个系数化简到 $9$ 个。

根据二次曲面的一般方程，也有自己的**判别式**对曲面形状进行判断，但算法较为复杂，此处未给出。

### 2.2.3 二次曲面的矩阵方程

有以下定义：
$$
x=
\begin{bmatrix}
x\\
y\\
z\\
1
\end{bmatrix},
x^T=
\begin{bmatrix}
x\ y\ z\ 1
\end{bmatrix},
Q=
\begin{bmatrix}
A &D &E &G\\
D &B &F &H\\
E &F &C &I\\
G &H &I &J
\end{bmatrix}
$$
二次曲面的矩阵方程为：
$$
x^TQx=0
$$
可以看到其矩阵方程和二次曲线是一样的，但 $x$ ， $x^T$ 和 $Q$ 不同。

在列举标准方程时，提到了四阶二次曲面和三阶二次曲面的概念，当时没有解释四阶和三阶的概念，因为从多项式角度解释比较复杂（因为系数个数增长过快），但从矩阵方程的角度解释起来简单很多。

四阶和三阶即系数矩阵 $Q$ 的**秩（*Rank*）**为 $3$ 或 $4$ 。

其他二阶以下的曲面方程均为退化的曲面，即为平面。

### 2.2.4 圆环面的标准方程

标准圆环面是将一个圆按照 $z$ 轴进行旋转得到，假设圆的半径为 $r$ ，圆心到旋转轴的半径为 $R$ ，则有：
$$
(x^2+y^2+z^2-(R^2-r^2))^2=4R^2(r^2-z^2)
$$
根据 $r$ 与 $R$ 关系的不同，有不同的几何特征：

* $r<R$ ，圆环面与旋转轴分离
* $r=R$ ，圆环面与旋转轴相切
* $r>R$ ，圆环面与旋转轴相交

## 三、齐次坐标系（*Homogeneous Coordinates*）

使用**齐次坐标系**的最常见的目的是为了处理**无限（*Infinity*）**的概念。在[**欧几里得坐标系（*Euclidean Coordinate System*）**](https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%A9%BA%E9%97%B4)中，无限的概念有时是不存在的，引入齐次坐标系后，无限就可以表示了。

但是，数学家们发现，将齐次坐标系用于空间几何时，会使问题变得简洁，能够简化许多在欧几里得坐标系中无法解决的问题。

现有两个实数 $a$ 和 $w$ ，计算 $\frac{a}{w}$ ，使 $a$ 固定，变化 $w$ 。则随着 $w$ 趋近于 $0$， $\frac{a}{w}$ 趋近于无穷大。因此当 $w=0$ 时，可以使用二元组 $(a,0)$ 表示无穷大。

在二维坐标系下，用 $\frac{x}{w}$ 和 $\frac{y}{w}$ 代替 $x$ 和 $y$ ，则：
$$
\begin{align}
f(x,y)=&Ax+By+C=0\\ \\
\xRightarrow{代入\frac{x}{w}和\frac{y}{w}}\ &\frac{Ax}{w}+\frac{By}{w}+C=0\\ \\
\xRightarrow{两边乘以w}\ &Ax+By+Cw=0
\end{align}
$$
如果是二次多项式，则有：
$$
\begin{align}
Ax^2+2Bxy+Cy^2+2Dxw+2Eyw+Fw^2=0
\end{align}
$$
如果令新的多项式为 $f(u,v,w)$ ，则有：
$$
f(u,v,w)=Au^2+2Buv+Cv^2+2Duw+2Evw+Fw^2
$$
其中 $u = \frac{x}{w}$ ， $v = \frac{y}{w}$ 。

可以看到，多项式的每一项关于自变量都是**同幂次**的，这就是齐次多项式。

将齐次多项式变回原多项式只需用 $\frac{x}{w}$ 和 $\frac{y}{w}$ 代替 $u$ 和 $v$ 并化简方程即可。

> **本章之后，为了方便，会以 $f(x,y,w)$ 表示齐次多项式**，本章节使用 $u$ 和 $v$ 只是为了避免自变量混淆且便于理解。
>
> 不用纠结齐次坐标系怎么来的，很多情况下，如果你的目标不是成为几何学大师，用好这个工具就足够了。

### 3.1 齐次坐标系的理解

从代数的角度来看，齐次坐标系引入了一个新的维度，相当于在原来平面的基础上添加了一个坐标轴。

为了更简单理解且不失一般性，我们从二维方程来看，添加 $w$ 后相当于在原来的 $xy$ 平面上新增了 $w$ 轴（为了简单， $w$ 轴垂直于 $xy$ 平面）。

（图片）

